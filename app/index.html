<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MobileNet Prediction</title>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet"></script>
</head>
<body>
<label>Select Images
    <select id="imageSelector">
        <option value="">From Dataset</option>
        <option value="kaggle/with-sunglasses-1.jpg">with-sunglasses-1.jpg</option>
        <option value="kaggle/with-sunglasses-2.jpg">with-sunglasses-2.jpg</option>
        <option value="kaggle/with-sunglasses-3.jpg">with-sunglasses-3.jpg</option>
        <option value="kaggle/with-sunglasses-4.jpg">with-sunglasses-4.jpg</option>
        <option value="kaggle/with-sunglasses-5.jpg">with-sunglasses-5.jpg</option>

        <option value="kaggle/without-sunglasses-1.jpg">without-sunglasses-1.jpg</option>
        <option value="kaggle/without-sunglasses-2.jpg">without-sunglasses-2.jpg</option>
        <option value="kaggle/without-sunglasses-3.jpg">without-sunglasses-3.jpg</option>
        <option value="kaggle/without-sunglasses-4.jpg">without-sunglasses-4.jpg</option>
        <option value="kaggle/without-sunglasses-5.jpg">without-sunglasses-5.jpg</option>

        <option value="">From Web</option>
        <option value="images/with-sunglasses-1.png">with-sunglasses-1.png</option>
        <option value="images/with-sunglasses-2.png">with-sunglasses-2.png</option>
        <option value="images/with-sunglasses-3.png">with-sunglasses-3.png</option>

        <option value="images/without-sunglasses-1.png">without-sunglasses-1.png</option>
        <option value="images/without-sunglasses-2.png">without-sunglasses-2.png</option>
        <option value="images/without-sunglasses-3.png">without-sunglasses-3.png</option>
    </select>
</label>
<img id="imagePreview" style="display: none;">
<p id="prediction"></p>

<script>
    async function predictImage(image) {
        const model = await mobilenet.load();

        const tensor = tf.browser.fromPixels(image).resizeNearestNeighbor([224, 224]).toFloat();
        const normalizedTensor = tensor.div(tf.scalar(255)).expandDims(0);

        return await model.classify(normalizedTensor);
    }

    document.getElementById('imageSelector').addEventListener('change', async (event) => {
        const image = document.getElementById('imagePreview');
        image.src = event.target.value;
        image.style.display = 'block';

        const predictions = await predictImage(image);
        console.log('predicted', predictions)
        document.getElementById('prediction').textContent = JSON.stringify(predictions);
    });
</script>
</body>
</html>